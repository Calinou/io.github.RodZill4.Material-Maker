app-id: io.github.RodZill4.Material-Maker
base: org.godotengine.godot.BaseApp
base-version: "3.2"
runtime: org.freedesktop.Platform
runtime-version: "19.08"
sdk: org.freedesktop.Sdk
command: material-maker
rename-icon: icon

finish-args:
  - --share=ipc
  - --socket=x11
  - --filesystem=home
  - --device=dri

modules:
  - name: material-maker
    buildsystem: simple

    sources:
      - type: archive
        url: https://github.com/RodZill4/material-maker/releases/download/0.92/material_maker_0_92_linux.tgz
        sha256: 571bceaedfaa749b66813534a727d917e7a806f7fb6e6d9eb91a4108db7a3e7a

      - type: script
        dest-filename: material_maker.sh
        commands:
          # `cd` is needed so that Material Maker can find its data directories.
          - cd /app/bin/
          # Use the `Dummy` audio driver to avoid error messages when starting the application from a terminal.
          - /app/bin/godot-runner --audio-driver Dummy --main-pack /app/bin/material-maker.pck "$@"

      - type: file
        url: https://raw.githubusercontent.com/RodZill4/material-maker/2b3651dc25e1737956c100579fbdf36abc5b0b70/icon.png
        sha256: 8d4420268d527e77067d3b2079d23033b9dfe687be4783132a6de8df8fc86835

      - type: file
        url: https://raw.githubusercontent.com/RodZill4/material-maker/0.92/material_maker/misc/linux/io.github.RodZill4.Material-Maker.desktop
        sha256: d8c96863144183d9f256229232c0cfe18b10518abdb2bba3477781a8d96f0133

      - type: file
        url: https://raw.githubusercontent.com/RodZill4/material-maker/2b3651dc25e1737956c100579fbdf36abc5b0b70/material_maker/misc/linux/io.github.RodZill4.Material-Maker.appdata.xml
        sha256: 0ab4dcfe3867f2bc25e9a03e5ffe59aee6d56a059d9aeca96f23b82485fd1811

    build-commands:
      - install -Dm755 material_maker.sh /app/bin/material-maker
      - install -Dm644 material_maker.pck /app/bin/material-maker.pck
      - mv {examples,library,nodes}/ /app/bin/
      - install -Dm644 icon.png -t /app/share/icons/hicolor/64x64/apps/
      - install -Dm644 io.github.RodZill4.Material-Maker.desktop -t /app/share/applications/
      - install -Dm644 io.github.RodZill4.Material-Maker.appdata.xml -t /app/share/appdata/
